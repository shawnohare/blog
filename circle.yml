machine:
  environment:
    THEME: "hugo-morphism"
  post:
    - mkdir -p themes static

dependencies:
  pre:
    - go get -v github.com/spf13/hugo
    - if [[ ! -d "${DIR}" ]];then git clone "${REPO}" "${DIR}";fi:
        environment:
          DIR: "themes/${THEME}"
          REPO: "https://github.com/shawnohare/${THEME}.git"
    - git pull:
        pwd: "themes/${THEME}" 
  cache_directories:
    - bin
    - themes

test:
  override:
    - hugo -v "--theme=${THEME}"

deployment:
  production:
    branch: master
    commands:
      - ./deploy.sh --config deploy.toml 
          pwd: "bin"
